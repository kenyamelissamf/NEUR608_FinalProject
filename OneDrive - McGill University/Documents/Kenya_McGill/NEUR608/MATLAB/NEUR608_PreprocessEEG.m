% Script generated by Brainstorm (18-Nov-2022)

% Input files
    %'AD0109/@rawAD0109_S1_Baseline_Rest/data_0raw_AD0109_S1_Baseline_Rest.mat', ...
    %'AD0109/@rawAD0109_S2_Baseline_Rest/data_0raw_AD0109_S2_Baseline_Rest.mat', ...
    %'AD0109/@rawAD0109_S3_Baseline_Rest/data_0raw_AD0109_S3_Baseline_Rest.mat', ...
    %'RP0129/@rawRP0129_S1_Baseline_Rest/data_0raw_RP0129_S1_Baseline_Rest.mat', ...
    %'RP0129/@rawRP0129_S2_Baseline_Rest/data_0raw_RP0129_S2_Baseline_Rest.mat', ...
    %'RP0129/@rawRP0129_S3_Baseline_Rest/data_0raw_RP0129_S3_Baseline_Rest.mat', ...
    %'FB0901/@rawFB0901_S1_Baseline_Rest/data_0raw_FB0901_S1_Baseline_Rest.mat', ...
    %'FB0901/@rawKM0404_S2_Baseline_Rest/data_0raw_FB0901_S2_Baseline_Rest.mat', ...
    %'FB0901/@rawKM0404_S3_Baseline_Rest/data_0raw_FB0901_S3_Baseline_Rest.mat', ...
    
    
sFiles = {...
    'KM0404/@rawKM0404_S1_15min_Rest/data_0raw_KM0404_S1_15min_Rest.mat', ...
    'KM0404/@rawKM0404_S2_15min_Rest/data_0raw_KM0404_S2_15min_Rest.mat', ...
    'KM0404/@rawKM0404_S3_15min_Rest/data_0raw_KM0404_S3_15min_Rest.mat', ...
    'KM0404/@rawKM0404_S1_15min_Motor/data_0raw_KM0404_S1_15min_Motor.mat', ...
    'KM0404/@rawKM0404_S2_15min_Motor/data_0raw_KM0404_S2_15min_Motor.mat', ...
    'KM0404/@rawKM0404_S3_15min_Motor/data_0raw_KM0404_S3_15min_Motor.mat', ...
    'KM0404/@rawKM0404_S1_45min_Rest/data_0raw_KM0404_S1_45min_Rest.mat', ...
    'KM0404/@rawKM0404_S2_45min_Rest/data_0raw_KM0404_S2_45min_Rest.mat', ...
    'KM0404/@rawKM0404_S3_45min_Rest/data_0raw_KM0404_S3_45min_Rest.mat', ...
    'KM0404/@rawKM0404_S1_45min_Motor/data_0raw_KM0404_S1_45min_Motor.mat', ...
    'KM0404/@rawKM0404_S2_45min_Motor/data_0raw_KM0404_S2_45min_Motor.mat', ...
    'KM0404/@rawKM0404_S3_45min_Motor/data_0raw_KM0404_S3_45min_Motor.mat', ...
    'CD1107/@rawCD1107_S1_15min_Motor/data_0raw_CD1107_S1_15min_Motor.mat', ...
    'CD1107/@rawCD1107_S1_15min_Rest/data_0raw_CD1107_S1_15min_Rest.mat', ...
    'CD1107/@rawCD1107_S1_45min_Rest/data_0raw_CD1107_S1_45min_Rest.mat', ...
    'CD1107/@rawCD1107_S1_45min_Motor/data_0raw_CD1107_S1_45min_Motor.mat', ...
    'MB0522/@rawMB0522_S1_15min_Motor/data_0raw_MB0522_S1_15min_Motor.mat', ...
    'MB0522/@rawMB0522_S2_15min_Motor/data_0raw_MB0522_S2_15min_Motor.mat', ...
    'MB0522/@rawMB0522_S1_15min_Rest/data_0raw_MB0522_S1_15min_Rest.mat', ...
    'MB0522/@rawMB0522_S2_15min_Rest/data_0raw_MB0522_S2_15min_Rest.mat', ...
    'MB0522/@rawMB0522_S1_45min_Rest/data_0raw_MB0522_S1_45min_Rest.mat', ...
    'MB0522/@rawMB0522_S2_45min_Rest/data_0raw_MB0522_S2_45min_Rest.mat', ...
    'MB0522/@rawMB0522_S1_45min_Motor/data_0raw_MB0522_S1_45min_Motor.mat', ...
    'MB0522/@rawMB0522_S2_45min_Motor/data_0raw_MB0522_S2_45min_Motor.mat'};

% Start a new report
bst_report('Start', sFiles);

% Process: Band-pass:0.5Hz-100Hz
sFiles = bst_process('CallProcess', 'process_bandpass', sFiles, [], ...
    'sensortypes', 'EEG', ...
    'highpass',    0.5, ...
    'lowpass',     100, ...
    'tranband',    0, ...
    'attenuation', 'strict', ...  % 60dB
    'ver',         '2019', ...  % 2019
    'mirror',      0, ...
    'read_all',    0);

% Process: Notch filter: 60Hz
sFiles = bst_process('CallProcess', 'process_notch', sFiles, [], ...
    'sensortypes', 'EEG', ...
    'freqlist',    60, ...
    'cutoffW',     1, ...
    'useold',      0, ...
    'read_all',    0);

% Process: Resample: 250Hz
sFiles = bst_process('CallProcess', 'process_resample', sFiles, [], ...
    'freq',     250, ...
    'read_all', 0);

% Process: ICA components: Infomax
sFiles = bst_process('CallProcess', 'process_ica', sFiles, [], ...
    'timewindow',   [], ...
    'eventname',    '', ...
    'eventtime',    [0, 0], ...
    'resample',     0, ...
    'bandpass',     [0, 0], ...
    'nicacomp',     24, ...
    'sensortypes',  'EEG', ...
    'icasort',      '', ...
    'usessp',       1, ...
    'ignorebad',    1, ...
    'saveerp',      0, ...
    'method',       1);  % Infomax:    EEGLAB / RunICA

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);
% bst_report('Email', ReportFile, username, to, subject, isFullReport);

